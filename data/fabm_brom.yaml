check_conservation: false
require_initialization: true
instances:
  B_NUTR:
    long_name: main_nutrients
    model: niva/brom_main_nutrients
    initialization:
      NH4: 0.0
      NO2: 0.0
      NO3: 5.0
      PO4: 1.0
      Si:  0.0
  B_EQ:
    long_name: equilibrium_constrants
    model: niva/brom_eq_constants
  B_CARB:
    long_name: carbonate
    model: niva/brom_carbon
    initialization:
      DIC: 2130.0 # total dissolved inorganic carbon (mmol C/m^3)
      Alk: 2300.0 # umol/kg
    coupling:
      Kc0:   B_EQ/Kc0
      Kc1:   B_EQ/Kc1
      Kc2:   B_EQ/Kc2
      Hplus: B_pH/Hplus
  B_CALC:
    long_name: calcium
    model: niva/brom_calcium
    initialization:
      CaCO3: 5.0
    coupling:
      DIC: B_CARB/DIC
      CO3: B_CARB/CO3
  B_pH:
    long_name: pH
    model: niva/brom_pH
    coupling:
      Kc1:      B_EQ/Kc1
      Kc2:      B_EQ/Kc2
      Kb:       B_EQ/Kb
      Kp1:      B_EQ/Kp1
      Kp2:      B_EQ/Kp2
      Kp3:      B_EQ/Kp3
      KSi:      B_EQ/KSi
      Knh4:     B_EQ/Knh4
      Kh2s:     B_EQ/Kh2s
      kso4:     B_EQ/kso4
      kflu:     B_EQ/kflu
      Kw:       B_EQ/Kw
      tot_free: B_EQ/tot_free
      DIC:      B_CARB/DIC
      PO4:      B_NUTR/PO4
      Si:       B_NUTR/Si
      NH4:      B_NUTR/NH4
      H2S:      B_SULF/H2S
      SO4:      B_SULF/SO4
  B_BIO:
    long_name: bio
    model: niva/brom_bio
    initialization:
      Phy: 0.01
      Het: 0.01
      PON: 0.01
      DON: 0.0
      O2:  300.0
    coupling:
      PO4:    B_NUTR/PO4
      Si:     B_NUTR/Si
      Sipart: B_SILI/Sipart
      NH4:    B_NUTR/NH4
      NO2:    B_NUTR/NO2
      NO3:    B_NUTR/NO3
      DIC:    B_CARB/DIC
      H2S:    B_SULF/H2S
      Baae:   B_BACT/Baae
      Bhae:   B_BACT/Bhae
      Baan:   B_BACT/Baan
      Bhan:   B_BACT/Bhan
      Hplus:  B_pH/Hplus
  B_BACT:
    long_name: bacteria
    model: niva/brom_bact
    initialization:
      Baae: 0.01
      Bhae: 0.01
      Baan: 0.01
      Bhan: 0.01
    coupling:
      NH4:      B_NUTR/NH4
      DON:      B_BIO/DON
      PON:      B_BIO/PON
      O2:       B_BIO/O2
      PO4:      B_NUTR/PO4
      DIC:      B_CARB/DIC
      H2S:      B_SULF/H2S
      Nitrif1:  B_NITR/Nitrif1
      Nitrif2:  B_NITR/Nitrif2
      anammox:  B_NITR/Anammox
      fe_ox1:   B_IRON/fe_ox1
      fe_rd:    B_IRON/fe_rd
      mn_ox1:   B_MANG/mn_ox1
      mn_rd1:   B_MANG/mn_rd1
      mn_rd2:   B_MANG/mn_rd2
      hs_ox:    B_SULF/hs_ox
      hs_no3:   B_SULF/hs_no3
      s2o3_ox:  B_SULF/s2o3_ox
      s0_ox:    B_SULF/s0_ox
      DcPM_O2:  B_BIO/DcPM_O2
      DcDM_O2:  B_BIO/DcDM_O2
      DcPM_NOX: B_NITR/DcPM_NOX
      DcDM_NOX: B_NITR/DcDM_NOX
      DcPM_SO4: B_SULF/DcPM_SO4
      DcDM_SO4: B_SULF/DcDM_SO4
      DcPM_Mn:  B_MANG/DcPM_Mn
      DcDM_Mn:  B_MANG/DcDM_Mn
      DcPM_Fe:  B_IRON/DcPM_Fe
      DcDM_Fe:  B_IRON/DcDM_Fe
      DcPM_ch4: B_METH/DcPM_ch4
  B_NITR:
    long_name: nitrogen_cycle
    model: niva/brom_nitrogen
    parameters:
      # Spec.rate of 1st st. of nitrification
      K_nitrif1: 0.01
      # Spec.rate of 2d st. of nitrification
      K_nitrif2: 0.1
      # Spec.rate of 1 stage of denitrif
      K_denitr1: 0.3
      # Spec.rate of 2 stage of denitrif
      K_denitr2: 0.20
      K_omno_no3: 0.001 # Half sat. of no3 for OM denitr. (uM N)
      K_omno_no2: 0.001 # Half sat. of no2 for OM denitr. (uM N)
      # Spec.rate of Anammox (1/d) (Gregoire, Lacroix, 2001)
      K_annamox: 0.8
      # Threshold of O2 saturation for nitrification (uM)
      O2s_nf: 5.
      # Threshold of O2 for denitrification, anammox, Mn reduction (uM O2)
      O2s_dn: 10.0
      r_n_p: 16.0  # N[uM]/P[uM]
      r_c_n: 8.0   # C[uM]/N[uM]
    coupling:
      NH4: B_NUTR/NH4
      NO2: B_NUTR/NO2
      NO3: B_NUTR/NO3
      DIC: B_CARB/DIC # carbon dioxide (mmol C/m^3)
      O2:  B_BIO/O2
      DON: B_BIO/DON
      PON: B_BIO/PON
      PO4: B_NUTR/PO4
  B_METH:
    long_name: methane
    model: niva/brom_methane
    parameters:
      s_omso_o2: 25.0 # threshold of o2 for OM sulfate reduction
      s_omso_no3: 5.0 # threshold of noX for OM sulfate reduction
      # Threshold of of SO4 for methane production from OM
      s_omch_so4: 30.
      # Specific rate of methane production from DON (Lopes et al., 2011)
      K_DON_ch4: 0.00014
      # Specific rate of methane production from PON
      K_PON_ch4: 0.00014
      # Specific rate of oxidation of CH4 with O2
      K_ch4_o2: 0.14
      # Specific rate of oxidation of CH4 with SO4
      K_ch4_so4: 0.0000274
      r_c_n: 8.0   # C[uM]/N[uM]
    initialization:
      CH4: 0.0001 # Methan (mmol C/m^3)
    coupling:
      DIC: B_CARB/DIC
      O2:  B_BIO/O2
      DON: B_BIO/DON
      PON: B_BIO/PON
      NO3: B_NUTR/NO3
      SO4: B_SULF/SO4
  B_SULF:
    long_name: sulfur_cycle
    model: niva/brom_sulfur
    parameters:
      # Specific rate of oxidation of H2S to S0 with O2 (1/d)
      K_hs_ox: 0.5
      K_s0_ox: 0.02   # Specific rate of oxidation of S0 with O2
      K_s2o3_ox: 0.01 # Specific rate of oxidation of S2O3 with O2
      # Specific rate of OM sulfate reduction with sulfate
      K_so4_rd: 0.000005
      # Specific rate of OM sulfate reduction with thiosulfate
      K_s2o3_rd: 0.001
      # Specific rate of S0 dispropotionation
      K_s0_disp:  0.001
      # Spec.rate of thiodenitrification (1/d)
      K_hs_no3: 0.8
      K_s0_no3:   0.9   # Specific rate of oxidation of S0 with NO3
      K_s2o3_no3: 0.01  # Specific rate of oxidation of S2O3 with NO3
      s_omso_o2: 25.0 # threshold of o2 for OM sulfate reduction
      s_omso_no3: 5.0 # threshold of noX for OM sulfate reduction
      r_n_p: 16.0  # N[uM]/P[uM]
      r_c_n: 8.0   # C[uM]/N[uM]
    initialization:
      H2S:    0.0
      S0:     0.0
      S2O3:   0.0
      SO4:    25000.
    coupling:
      NH4: B_NUTR/NH4
      NO3: B_NUTR/NO3
      DIC: B_CARB/DIC # carbon dioxide (mmol C/m^3)
      O2:  B_BIO/O2
      DON: B_BIO/DON
      PON: B_BIO/PON
      PO4: B_NUTR/PO4
  B_IRON:
    long_name: iron
    model: niva/brom_iron
    parameters:
      # Rate of accel. sink. of part. with settled metal hydroxides (1/d)
      Wm: 10.0
      # Specific rate of oxidation of Fe2 to Fe3  with O2 (1/d)
      K_fe_ox1: 0.5
      # Specific rate of oxidation of Fe2 to Fe3  with MnO2 (1/d)
      K_fe_ox2: 0.001
      # Specific rate of reduction of Fe3 to Fe2  with H2S (1/day)
      K_fe_rd: 0.5
      # FeS equilibrium constant
      K_fes: 2510.0
      # Specific rate of precipitation of FeS from Fe2 with H2S (1/day)
      K_fes_form: 5.e-4
      # Specific rate of dissollution of FeS to Fe2 and H2S  (1/day)
      K_fes_diss: 1.e-6
      # Specific rate of oxidation of FeS with O2 (1/day)
      K_fes_ox: 0.001
      # Specific rate of oxidation of DON with Fe3 (1/day)
      K_DON_fe: 0.00005
      # Specific rate of oxidation of PON with Fe3 (1/day)
      K_PON_fe: 0.00001
      # Specific rate of FeS2 formation by FeS oxidation by H2S (1/day)
      K_fes2_form: 0.000001
      # Specific rate of pyrite oxidation by O2 (1/uM/d)
      K_fes2_ox: 0.00044
      # Threshold of Fe2 reduciton
      s_feox_fe2: 0.001
      # Threshold of Fe3 reduciton (uM Fe)
      s_ferd_fe3: 0.01
      # Conditional equilibrium constant (uM2)
      # for Mn2+CO3->FeCO3 (Meysman,2003)
      K_feco3: 15.
      # Specific rate of dissolution of FeCO3 (1/day)
      K_feco3_diss: 7.e-4
      # Specific rate of formation of FeCO3 (1/day)
      K_feco3_form: 3.e-4
      # Specific rate of oxidation of FeCO3 with O2 (1/day)
      K_feco3_ox: 0.0027
      K_ferd_hs:  1.0   # half sat. of Fe reduction (uM S)
      K_omno_no3: 0.001 # Half sat. of no3 for OM denitr. (uM N)
      # Threshold of O2 for denitrification, anammox, Mn reduction (uM O2)
      O2s_dn: 10.0
      # Fe[uM]/N[uM] (Boudrau, 1996)
      r_fe_n: 26.5
      # Fe[uM]/P[uM] partitioning coeff. for Fe oxide (Yakushev, 2007)
      r_fe3_p: 2.7
      #! Fe[uM]/Si[uM] partitioning coeff. for Fe oxide
      r_fe3_si: 3.
    initialization:
      Fe2:    0.5
      Fe3:    0.0
      FeS:    0.0
      FeCO3:  0.0
      FeS2:   0.0
    coupling:
      Mn2:   B_MANG/Mn2
      Mn4:   B_MANG/Mn4
      H2S:   B_SULF/H2S
      S0:    B_SULF/S0
      SO4:   B_SULF/SO4
      Si:    B_NUTR/Si
      DIC:   B_CARB/DIC # carbon dioxide (mmol C/m^3)
      PO4:   B_NUTR/PO4
      O2:    B_BIO/O2
      DON:   B_BIO/DON
      PON:   B_BIO/PON
      Hplus: B_pH/Hplus
  B_MANG:
    long_name: manganese
    model: niva/brom_manganese
    parameters:
      # Rate of accel. sink. of part. with settled metal hydroxides (1/d)
      Wm: 10.0
      K_mn_ox1: 0.1 # Specific rate of oxidation of Mn2 to Mn3 with O2 (1/d)
      K_mn_ox2: 0.2 # Specific rate of oxidation of Mn3 to Mn4 with O2 (1/d)
      # Specific rate of reduction of Mn4 to Mn3 with H2S (1/d)
      K_mn_rd1: 0.5
      # Specific rate of reduction of Mn3 to Mn2 with H2S (1/d)
      K_mn_rd2: 1.0
      # Conditional equilibrium constant for MnS from Mn2 with H2S (M)
      K_mns:    1500.
      # Specific rate of dissolution of MnS to Mn2 and H2S (1/d)
      K_mns_diss: 0.0005
      # Spec. rate of form. of MnS from Mn2 with H2S (1/d)
      K_mns_form: 0.00001
      # Conditional equilibrium constant (uM2)
      # for Mn2+CO3->MnCO3 (Meysman,2003)
      K_mnco3: 1.
      # Specific rate of dissolution of MnCO3 (1/d)
      K_mnco3_diss: 7.e-4
      # Specific rate of formation of MnCO3 (1/d)
      K_mnco3_form: 3.e-4
      # Specific rate of oxidation of MnCO3 with O2 (1/d)
      K_mnco3_ox: 0.0027
      # Specific rate of oxidation of DON with Mn4 (1/d)
      K_DON_mn: 0.001
      # Specific rate of oxidation of PON with Mn4 (1/d)
      K_PON_mn: 0.001
      # threshold of Mn2 oxidation (uM Mn)
      s_mnox_mn2: 0.01
      # threshold of Mn3 oxidation (uM Mn)
      s_mnox_mn3: 0.01
      # threshold of Mn4 reduciton (uM Mn)
      s_mnrd_mn4: 0.01
      # threshold of Mn3 reduciton  (uM Mn)
      s_mnrd_mn3: 0.01
      # Threshold of O2 for denitrification, anammox, Mn reduction (uM O2)
      O2s_dn: 10.0
      K_mnrd_hs:  1.0   # half sat. of Mn reduction (uM S)
      # Half sat. of Mn oxidation (uM O2)
      K_mnox_o2: 2.0
      # Mn[uM]/N[uM] (Boudrau, 1996)
      r_mn_n: 13.25
      # Mn[uM]/P[uM] complex stoichiometric coeff. for Mn(III)
      r_mn3_p: 0.67
    initialization:
      Mn2:    0.5
      Mn3:    0.0
      Mn4:    0.0
      MnS:    0.0
      MnCO3:  0.0
    coupling:
      S0:    B_SULF/S0
      H2S:   B_SULF/H2S
      DIC:   B_CARB/DIC # carbon dioxide (mmol C/m^3)
      PO4:   B_NUTR/PO4
      O2:    B_BIO/O2
      DON:   B_BIO/DON
      PON:   B_BIO/PON
      Hplus: B_pH/Hplus
  B_SILI:
    long_name: silicon
    model: niva/brom_silicon
    parameters:
      # Sinking (Gregoire, Lacroix, 2001)
      Wsed: 5.0 # Rate of sinking of detritus (m/d)
      # Si dissollution rate constant (Popova,04)
      K_sipart_diss: 0.008
    initialization:
      Sipart: 0.0
    coupling:
      Si: B_NUTR/Si
